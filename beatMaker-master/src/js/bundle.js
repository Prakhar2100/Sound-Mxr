"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createSuper(e){return function(){var t,n=_getPrototypeOf(e);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var Drumkit=function(){function e(){_classCallCheck(this,e),this.pads=document.querySelectorAll("div.pad"),this.playBtn=document.querySelector("button.play"),this.currentKick="../public/assets/sound/kick-classic.wav",this.currentSnare="../public/assets/sound/snare-acounstic01.wav",this.currentHihat="../public/assets/sound/hihat-acounstic01.wav",this.currenthard="../public/assets/sounds/download1.wav",this.kickAudio=document.querySelector("audio.kick-sound"),this.snareAudio=document.querySelector("audio.snare-sound"),this.hithatAudio=document.querySelector("audio.hihat-sound"),this.hardcode=document.querySelector("audio.hard-code"),this.index=0,this.bpm=150,this.isPlaying=null,this.selects=document.querySelectorAll("select"),this.muteBtns=document.querySelectorAll("button.mute"),this.bpmSlider=document.querySelector("input.bpm-slider")}return _createClass(e,[{key:"activePad",value:function(e){e.target.classList.toggle("active"),this.storeSequence(e)}},{key:"repeat",value:function(){var e=this,t=this.index%8;document.querySelectorAll("div.b".concat(t)).forEach(function(t){t.classList.contains("active")?(t.style.animation="playTrack 350ms alternate cubic-bezier(0.48, 0.88, 0.43, 0.86)",t.classList.contains("kick-pad")&&(e.kickAudio.currentTime=0,e.kickAudio.play()),t.classList.contains("snare-pad")&&(e.snareAudio.currentTime=0,e.snareAudio.play()),t.classList.contains("hard-pad")&&(e.hardcode.currentTime=0,e.hardcode.play()),t.classList.contains("hihat-pad")&&(e.hithatAudio.currentTime=0,e.hithatAudio.play())):t.style.animation="shines 500ms reverse linear forwards"}),this.index++}},{key:"start",value:function(){var e=this,t=60/this.bpm*1e3;this.isPlaying?(clearInterval(this.isPlaying),this.isPlaying=null):this.isPlaying=setInterval(function(){e.repeat()},t)}},{key:"updateBtn",value:function(){this.isPlaying?(this.playBtn.innerText="Play",this.playBtn.classList.remove("active")):(this.playBtn.innerText="Stop",this.playBtn.classList.add("active"))}},{key:"changeSound",value:function(e){var t=e.target.name,n=e.target.value;this.storeChangeSound(e),"kick-select"===t?this.kickAudio.src=n:"snare-select"===t?this.snareAudio.src=n:"hihat-select"===t?this.hithatAudio.src=n:"hardcode-select"===t&&(this.hardcode.src=n)}},{key:"mute",value:function(e){var t,n=e.target.getAttribute("data-track");e.target.classList.toggle("active")?(e.target.firstElementChild.innerText="volume_off",t=0):(e.target.firstElementChild.innerText="volume_up",t=1),this.storeMute(e),"0"===n?this.kickAudio.volume=t:"1"===n?this.snareAudio.volume=t:"2"===n?this.hithatAudio.volume=t:"3"===n&&(this.hardcode.volume=t)}},{key:"changeBpm",value:function(e){var t=document.querySelector(".bpm-value");this.bpm=e.target.value,localStorage.setItem("bpm",e.target.value),t.innerText=e.target.value}},{key:"updateInterval",value:function(){clearInterval(this.isPlaying),this.isPlaying=null,document.querySelector("button.play").classList.contains("active")&&this.start()}},{key:"storeSequence",value:function(e){var t=e.target.parentNode.getAttribute("data-index"),n=_toConsumableArray(e.target.parentNode.children).indexOf(e.target),r=JSON.parse(localStorage.getItem("sequence".concat(t)))||[];-1==r.indexOf(n)?r.push(n):r.splice(r.indexOf(n),1),localStorage.setItem("sequence".concat(t),JSON.stringify(r))}},{key:"storeChangeSound",value:function(e){localStorage.setItem(e.target.name,e.target.value)}},{key:"storeMute",value:function(e){var t;t=e.target.classList.contains("active")?1:0,localStorage.setItem("mute"+e.target.getAttribute("data-track"),t)}}]),e}(),drumKit=new Drumkit;drumKit.pads.forEach(function(e){e.addEventListener("click",function(e){drumKit.activePad(e)}),e.addEventListener("animationend",function(){this.style.animation=""})}),drumKit.playBtn.addEventListener("click",function(){drumKit.updateBtn(),drumKit.start()}),drumKit.selects.forEach(function(e){e.addEventListener("change",function(){drumKit.changeSound(event)})}),drumKit.muteBtns.forEach(function(e){e.addEventListener("click",function(e){drumKit.mute(e)})}),drumKit.bpmSlider.addEventListener("input",function(e){drumKit.changeBpm(e)}),drumKit.bpmSlider.addEventListener("change",function(e){drumKit.updateInterval(e)});var Dropdown=function(){function e(){_classCallCheck(this,e),this.helpButton=document.querySelector("span.help-info")}return _createClass(e,[{key:"activeDropDown",value:function(){this.nextElementSibling.classList.toggle("active")}}]),e}(),dropdown=new Dropdown;dropdown.helpButton.addEventListener("mouseenter",dropdown.activeDropDown),dropdown.helpButton.addEventListener("mouseleave",dropdown.activeDropDown);var ChangeTheme=function(){function e(){_classCallCheck(this,e),this.themeButton=document.querySelector("button.btn-theme")}return _createClass(e,[{key:"active",value:function(){this.themeButton.classList.toggle("active")?(this.themeButton.firstElementChild.innerText="brightness_7",this.setColor()):(this.themeButton.firstElementChild.innerText="brightness_5",this.setColor())}},{key:"setColor",value:function(){this.themeButton.classList.contains("active")?(document.body.classList.add("dark-theme"),localStorage.setItem("darkTheme",1)):(document.body.classList.remove("dark-theme"),localStorage.setItem("darkTheme",0))}}]),e}(),changeTheme=new ChangeTheme;changeTheme.themeButton.addEventListener("click",function(){changeTheme.active()});var LastState=function(e){function t(){var e;return _classCallCheck(this,t),(e=n.call(this)).darkTheme=parseInt(localStorage.getItem("darkTheme")),e.getBpm=localStorage.getItem("bpm"),e.mutes=[parseInt(localStorage.getItem("mute0")),parseInt(localStorage.getItem("mute1")),parseInt(localStorage.getItem("mute2")),parseInt(localStorage.getItem("mute3"))],e.selecteds={"snare-select":localStorage.getItem("snare-select"),"hihat-select":localStorage.getItem("hihat-select"),"kick-select":localStorage.getItem("kick-select"),"hardcode-select":localStorage.getItem("hardcode-select")},e.sequences=function(){return{0:JSON.parse(localStorage.getItem("sequence0")),1:JSON.parse(localStorage.getItem("sequence1")),2:JSON.parse(localStorage.getItem("sequence2")),3:JSON.parse(localStorage.getItem("sequence3"))}},e.padBox=document.querySelectorAll("div.pad-box"),e.btnReset=document.querySelector("button.btn-reset"),e}_inherits(t,Drumkit);var n=_createSuper(t);return _createClass(t,[{key:"setState",value:function(){var e=this;this.darkTheme&&changeTheme.themeButton.dispatchEvent(new Event("click")),this.muteBtns.forEach(function(t,n){e.mutes[n]&&e.muteBtns[n].dispatchEvent(new Event("click"))}),this.getBpm&&(this.bpmSlider.value=this.getBpm,this.bpmSlider.dispatchEvent(new Event("input"))),this.selects.forEach(function(t){e.selecteds[t.name]&&(t.value=e.selecteds[t.name],t.dispatchEvent(new Event("change")))});var t=this.sequences();for(var n in t){var r=this.padBox[n].children;for(var a in r){var i=_toConsumableArray(r).indexOf(r[a]);t[n]&&-1!=t[n].indexOf(i)&&r[a].classList.add("active")}}}},{key:"resetPadState",value:function(){var e=this.sequences();for(var t in e){var n=this.padBox[t].children;for(var r in n){var a=_toConsumableArray(n).indexOf(n[r]);e[t]&&-1!=e[t].indexOf(a)&&n[r].classList.remove("active")}}localStorage.setItem("sequence0","[]"),localStorage.setItem("sequence1","[]"),localStorage.setItem("sequence2","[]"),localStorage.setItem("sequence3","[]")}}]),t}(),lastState=new LastState;document.addEventListener("DOMContentLoaded",function(){lastState.setState()}),lastState.btnReset.addEventListener("click",function(e){lastState.resetPadState(e),e.target.firstChild.style.transform="rotate(-360deg)",e.target.firstChild.addEventListener("transitionend",function(e){e.target.style.transform="rotate(0deg)"})});